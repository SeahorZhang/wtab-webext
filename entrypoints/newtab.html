<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="Description" content="一个简洁、美观、实用的浏览器起始页。" />
    <title>新标签页</title>
    <style>
      html {
        height: 100%;
      }

      body {
        max-width: 100vw;
        height: 100vh;
        margin: 0;
        overflow: hidden;
        background-color: #333;
        -webkit-tap-highlight-color: transparent;
        -webkit-user-select: none;
        user-select: none;
      }

      iframe {
        width: 100%;
        height: 100%;
        border: none;
      }
    </style>
  </head>

  <body>
    <iframe
      id="my-wtab"
      allow="clipboard-read; clipboard-write"
      src="https://www.wtab.cn"
    ></iframe>
  </body>

  <script>
    chrome.runtime.onMessage.addListener((message, sender, sendResponse) => {
      if (message.type === "SEND_TO_IFRAME") {
        const iframe = document.getElementById("my-wtab");
        iframe?.contentWindow?.postMessage(
          {
            type: "FOR_WTAB_IFRAME",
            payload: message.payload,
          },
          "*"
        );

        window.addEventListener(
          "message",
          (event) => {
            if (event.data?.type !== "FROM_WTAB_IFRAME") return;
            chrome.runtime.sendMessage({
              type: "FROM_WTAB_IFRAME",
              payload: event.data.payload,
            });
          },
          { once: true }
        );
      }
    });
  </script>
</html>
